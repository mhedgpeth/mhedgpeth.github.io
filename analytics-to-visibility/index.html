<!doctype html><html prefix="og: http://ogp.me/ns#" lang=en-us><head itemscope itemtype=https://hedge-ops.com/><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta property="og:locale" content="en"><meta name=language content="en"><title itemprop=name>Migrating from Chef Analytics to Chef Visibility &#183; Michael Hedgpeth</title><meta property="og:title" content="Migrating from Chef Analytics to Chef Visibility &#183; Michael Hedgpeth"><meta name=twitter:title content="Migrating from Chef Analytics to Chef Visibility &#183; Michael Hedgpeth"><meta itemprop=name content="Migrating from Chef Analytics to Chef Visibility &#183; Michael Hedgpeth"><meta name=application-name content="Michael Hedgpeth"><meta property="og:site_name" content="Michael Hedgpeth"><base href=https://hedge-ops.com/analytics-to-visibility/><link rel=canonical href=https://hedge-ops.com/analytics-to-visibility/ itemprop=url><meta name=url content="https://hedge-ops.com/analytics-to-visibility/"><meta name=twitter:url content="https://hedge-ops.com/analytics-to-visibility/"><meta property="og:url" content="https://hedge-ops.com/analytics-to-visibility/"><meta itemprop=image content="https://hedge-ops.com/images/michael.jpg"><meta property="og:image" content="https://hedge-ops.com/images/michael.jpg"><meta name=twitter:image content="https://hedge-ops.com/images/michael.jpg"><meta name=twitter:image:src content="https://hedge-ops.com/images/michael.jpg"><meta name=twitter:card content="summary_large_image"><meta property="og:type" content="article"><meta itemprop=description content="The other day I was at lunch with my customer architect at Chef. We were talking about our situation. Our reference architecture fits Chef&amp;rsquo;s reference arc"><meta property="og:description" content="The other day I was at lunch with my customer architect at Chef. We were talking about our situation. Our reference architecture fits Chef&amp;rsquo;s reference arc"><meta name=description content="The other day I was at lunch with my customer architect at Chef. We were talking about our situation. Our reference architecture fits Chef&amp;rsquo;s reference arc"><meta name=twitter:description content="The other day I was at lunch with my customer architect at Chef. We were talking about our situation. Our reference architecture fits Chef&amp;rsquo;s reference arc"><meta property="article:published_time" content="2016-10-16T08:00:00Z"><meta name=twitter:label1 value="Reading time"><meta name=twitter:data1 value="6 minutes"><meta name=twitter:label2 value=Published><meta name=twitter:data2 value="October 16, 2016"><meta property="article:tag" content="chef"><meta property="og:updated_time" content="2016-10-16T08:00:00Z"><meta property="og:article:author" content="Michael"><meta property="article:author" content="Michael"><meta name=author content="Michael"><meta name=generator content="Hugo 0.72.0"><link rel=dns-prefetch href=//fonts.googleapis.com><link rel=preconnect href=https://fonts.gstatic.com/ crossorigin><link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap" rel=stylesheet><link rel=stylesheet href=https://hedge-ops.com/css/styles.min.ef433e47a104e30937dfad230e28b6dd329c9b4fe18ff4925850da1f24df3133.css integrity="sha256-70M+R6EE4wk3360jDii23TKcm0/hj/SSWFDaHyTfMTM="><link href=/index.xml rel=alternate type=application/rss+xml title="Michael Hedgpeth"><script src=https://cdnjs.cloudflare.com/ajax/libs/turbolinks/5.2.0/turbolinks.js></script></head><body class="bg-gradient flex flex-col min-h-screen"><header id=header class="w-full m-0 fixed z-10 transition-all duration-300 ease-in-out border-t-4 border-gray-300 backdrop-filter-blur"><div id=header-container class="max-w-7xl mx-auto p-6 flex items-center flex-wrap lg:flex-no-wrap relative justify-between"><a href=https://hedge-ops.com/ class="tracking-tighter leading-10 text-3xl font-semibold text-gray-600 flex flex-shrink-0">Michael Hedgpeth</a><div class="block lg:hidden mx-2"><button class="nav-button w-10 h-10 justify-center flex items-center opacity-75 hover:opacity-100 transition duration-300 ease-in-out"><svg class="fill-current h-4 w-4" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><title>Menu</title><path d="M0 3h20v2H0V3zm0 6h20v2H0V9zm0 6h20v2H0v-2z"/></svg></button>
<button class="hidden nav-button w-10 h-10 justify-center flex items-center opacity-75 hover:opacity-100 transition duration-300 ease-in-out"><svg class="fill-current h-4 w-4" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><title>Close menu</title><polygon points="11 9 22 9 22 11 11 11 11 22 9 22 9 11 -2 11 -2 9 9 9 9 -2 11 -2" transform="rotate(45 10 10)"/></svg></button></div><div class="absolute right-8 top-16 lg:relative lg:right-0 lg:top-0 flex flex-col lg:flex-row items-center rounded-md bg-white shadow lg:bg-transparent lg:shadow-none"><nav id=nav-social-links class="p-4 lg:p-0 text-gray-600 hidden lg:block lg:order-last w-full lg:w-auto lg:ml-3"><ul class="flex justify-end"><li><a class="block p-2 opacity-75 hover:opacity-100 transition duration-300 ease-in-out" title=Twitter href=https://www.twitter.com/michaelhedgpeth rel=me><svg class="fill-current w-5 h-5" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><title>Twitter</title><path d="M6.29 18.25c7.55.0 11.67-6.25 11.67-11.67v-.53c.8-.59 1.49-1.3 2.04-2.13-.75.33-1.54.55-2.36.65a4.12 4.12.0 001.8-2.27c-.8.48-1.68.81-2.6 1a4.1 4.1.0 00-7 3.74 11.65 11.65.0 01-8.45-4.3 4.1 4.1.0 001.27 5.49C2.01 8.2 1.37 8.03.8 7.7v.05a4.1 4.1.0 003.3 4.03 4.1 4.1.0 01-1.86.07 4.1 4.1.0 003.83 2.85A8.23 8.23.0 010 16.4a11.62 11.62.0 006.29 1.84"/></svg></a></li><li><a class="block p-2 opacity-75 hover:opacity-100 transition duration-300 ease-in-out" title=Github href=https://www.github.com/mhedgpeth rel=me><svg class="fill-current w-5 h-5" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><title>GitHub</title><path d="M10 0A10 10 0 006.84 19.49c.5.1.68-.22.68-.48l-.01-1.7c-2.78.6-3.37-1.34-3.37-1.34-.46-1.16-1.11-1.47-1.11-1.47-.9-.62.07-.6.07-.6 1 .07 1.53 1.03 1.53 1.03.9 1.52 2.34 1.08 2.91.83.1-.65.35-1.09.63-1.34-2.22-.25-4.55-1.11-4.55-4.94.0-1.1.39-1.99 1.03-2.69a3.6 3.6.0 01.1-2.64s.84-.27 2.75 1.02a9.58 9.58.0 015 0c1.91-1.3 2.75-1.02 2.75-1.02.55 1.37.2 2.4.1 2.64.64.7 1.03 1.6 1.03 2.69.0 3.84-2.34 4.68-4.57 4.93.36.31.68.92.68 1.85l-.01 2.75c0 .26.18.58.69.48A10 10 0 0010 0"/></svg></a></li><li><a class="block p-2 opacity-75 hover:opacity-100 transition duration-300 ease-in-out" title=Linkedin href=https://linkedin.com/in/michael-hedgpeth rel=me><svg class="fill-current w-5 h-5" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><title>LinkedIn</title><path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853.0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601.0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144.0-2.063-.926-2.063-2.065.0-1.138.92-2.063 2.063-2.063 1.14.0 2.064.925 2.064 2.063.0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225.0H1.771C.792.0.0.774.0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2.0 22.222.0h.003z"/></svg></a></li><li><a class="block p-2 opacity-75 hover:opacity-100 transition duration-300 ease-in-out" title=Feed href=/index.xml><svg class="fill-current w-5 h-5" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><title>RSS</title><path d="M19.199 24C19.199 13.467 10.533 4.8.0 4.8V0c13.165.0 24 10.835 24 24h-4.801zM3.291 17.415c1.814.0 3.293 1.479 3.293 3.295.0 1.813-1.485 3.29-3.301 3.29C1.47 24 0 22.526.0 20.71s1.475-3.294 3.291-3.295zM15.909 24h-4.665c0-6.169-5.075-11.245-11.244-11.245V8.09c8.727.0 15.909 7.184 15.909 15.91z"/></svg></a></li></ul></nav><nav id=nav-menu class="p-4 lg:p-0 hidden lg:block w-full lg:w-auto text-gray-600"><ul class="w-full flex flex-col lg:flex-row justify-end items-end lg:items-center"><li class="flex my-2 lg:my-2 mx-1 lg:mx-2"><a title=About class="uppercase font-bold lg:py-2 lg:px-3 rounded text-sm opacity-75 hover:opacity-100 transition duration-300 ease-in-out" href=/about>About</a></li><li class="flex my-2 lg:my-2 mx-1 lg:mx-2"><a title=Speaking class="uppercase font-bold lg:py-2 lg:px-3 rounded text-sm opacity-75 hover:opacity-100 transition duration-300 ease-in-out" href=/speaking>Speaking</a></li></ul></nav></div></div></header><main class="flex-1 mt-12 max-w-3xl mt-32 mx-auto text-gray-700 w-full"><div id=reading-progress-bar role=presentation class="fixed z-10 top-0 left-0 h-1 bg-gray-700"></div><article class=article><header class="text-center pt-10 pb-6"><small class="text-center text-sm"><time class=text-gray-500 datetime=2016-10-16T08:00:00+00:00>October 16, 2016</time>
<a href=https://hedge-ops.com/tags/chef/ class="inline-flex items-center px-4 py-1 rounded-full no-underline bg-orange-100 text-orange-800 hover:bg-orange-300 ml-4">chef</a></small><h1 class="leading-9 text-center"><a href=https://hedge-ops.com/analytics-to-visibility/ class="no-underline inline-block text-black relative"><div class=dots aria-hidden=true></div>Migrating from Chef Analytics to Chef Visibility</a></h1></header><div class=article__content><div class=full-width><img src=/images/feature-analytics-to-visibility.jpg alt="Analytics to Visibility"></div><p>The other day I was at lunch with my customer architect at Chef. We were talking about our situation. Our reference architecture fits Chef&rsquo;s reference architecture from about a year ago, which consists of a Chef Server and an Analytics Server as the core solution. Change takes a while, so I had been delaying setting up a Chef Automate environment before I got some other things accomplished.</p><p>However, at lunch we both were convinced that a <a href=https://docs.chef.io/visibility.html>Chef Visibility node</a> could easily replace a Chef Analytics node and set our teams up better for where Chef is going. We would set the server up in a POC mode which would mean we had no real backup plan, but that&rsquo;s OK because we are not really using Chef Analytics in a useful way.</p><p>This strategy is pretty typical of one I&rsquo;ve used lately: <strong>let people see what you&rsquo;re talking about and interact with it, even if it&rsquo;s not in the &ldquo;perfect final state&rdquo;</strong>. Then, with experience as a guide, take the next step to do it the &ldquo;right&rdquo; way. We will likely end up with a central Visibility server but I don&rsquo;t want to risk everything just to make that happen. So we set this up instead and move things forward.</p><p>After the discussion with my customer architect, <a href=https://www.linkedin.com/in/thomas-cate-9b63a28>Thomas Cate</a> helped me come up with this guide. I wrote everything down and thought it might be good to share with the community, in case anyone else was thinking of going this way.</p><h1 id=migration-steps>Migration Steps</h1><p>This will migrate an existing Chef Analytics Server to a Chef Visibility Server in POC mode.</p><h2 id=back-up-your-keys-on-the-analytics-server>Back up your keys on the analytics server</h2><p>We&rsquo;re getting ready to uninstall Analytics, but we want to keep the keys because we&rsquo;ll use them later.</p><ul><li>Find the key location in <code>/etc/opscode-analytics/opscode-analytics.rb</code>. The keys will likely be located in <code>/etc/pki/tls/certs</code> and <code>/etc/pki/tls/private</code></li><li>Back up the keys to <code>~/cert-backup</code></li></ul><h2 id=clean-and-uninstall-chef-analytics>Clean and uninstall Chef Analytics</h2><p>Let&rsquo;s get rid of analytics now:</p><ul><li>Run <code>opscode-analytics-ctl cleanse</code></li><li>Run <code>opscode-analytics-ctl stop</code></li><li>Remove the package <code>yum remove opscode-analytics</code></li><li>Run <code>sudo rm -rf /opt/opscode-analytics</code></li><li>Reboot server <code>sudo reboot now</code></li></ul><h2 id=remove-analytics-from-the-chef-server>Remove Analytics from the Chef Server</h2><p>On the Chef Server,</p><ul><li>open <code>/etc/opscode/chef-server.rb</code> and comment out ocid for analytics</li><li>run <code>chef-server-ctl reconfigure</code></li></ul><h2 id=install-automate>Install Automate</h2><ul><li>Navigate to the <a href=https://downloads.chef.io/automate/>downloads page</a> and copy the appropriate link</li><li>On the Analytics Server, wget that link to download it to the user home, for example: <code>wget https://packages.chef.io/stable/el/7/delivery-0.5.370-1.el7.x86_64.rpm</code> for my CentOS box</li><li>Install the package, on CentOS: <code>sudo rpm -Uvh delivery-0.5.370-1.el6.x86_64.rpm</code>. When it asks you to configure the Delivery Server, say no</li></ul><h2 id=set-up-licensing>Set up Licensing</h2><p>You&rsquo;ll need to get a <code>delivery.license</code> from a friend at Chef. You also get your pem key for your Chef Server as a one-time use to authenticate to it and add workflow stuff. I&rsquo;m not using that, so this was not really needed, but you know, we do it anyways.</p><ul><li>Run <code>sudo delivery-ctl setup --license ~/delivery.license --key ~/[your-name].pem --server-url https://[your-chef-server]/organizations/[your-org] --fqdn analytics.[your-domain].com</code></li><li>When it asks for an organization, use your company name. The organization can be the same for different visibility servers. In fact, one can argue in this situation it&rsquo;s quite useless; it&rsquo;s more for multitenancy.</li></ul><p>You should probably copy the <code>server-url</code> from your <code>knife.rb</code> file.</p><h2 id=finalize-installation>Finalize installation</h2><ul><li>run <code>sudo delivery-ctl reconfigure</code></li><li>check that the settings in <code>/etc/delivery/delivery.rb</code> are good (especially the FQDN)</li></ul><h2 id=set-up-certificates>Set up certificates</h2><p>Now it&rsquo;s time to reuse your certificates that you backed up earlier.</p><ul><li>Put the ssl certs in place <code>/var/opt/delivery/nginx/ca</code> - <strong>Important:</strong> these files need to same name as what is there by default. So you should copy by name and change the file name of what you had before.</li><li>Restart nginx <code>sudo delivery-ctl restart nginx</code></li><li>Make sure it&rsquo;s working with <code>delivery-ctl status</code></li></ul><h2 id=set-up-an-admin-user>Set up an Admin User</h2><ul><li>Run <code>delivery-ctl create-enterprise [enterprise] --ssh-pub-key-file=/etc/delivery/builder_key.pub</code></li></ul><p>This will generate user information that will be output to your command line:</p><pre><code>Created enterprise: companyname
Admin username: admin
Admin password: blahblahblah
Builder Password: blahblahblah-2
Web login: https://analytics.mycompany.com/e/companyname/
</code></pre><p>Navigate to that web login and you should see the automate login. Login with &ldquo;admin&rdquo; and the password it gives you.</p><h2 id=set-up-more-users>Set up more users</h2><p>At this point you can change the admin password to something you can remember and add users. This has to be separate from the Chef Server because there are many Chef Servers to one Visibility Server. Well, not in this case, but that&rsquo;s the design.</p><p>So you have two options:</p><ol><li>Set up a bunch of users manually</li><li>Set up LDAP authentication following <a href=https://docs.chef.io/integrate_delivery_ldap.html>these directions</a></li></ol><h2 id=configure-data-collector-on-chef-visibility-server>Configure Data Collector on Chef Visibility server</h2><p>Now I&rsquo;m going to set up a token for configuring a data collector for my clients to talk to the Chef Visiblity server:</p><ul><li>Create a Guid (on PowerShell I ran: <code>[guid]::NewGuid()</code>)</li><li>Add data collector configuration to <code>/etc/delivery/delivery.rb</code>:
<code>data_collector['token'] = 'my-guid-here'</code></li><li>Run <code>sudo delivery-ctl reconfigure</code></li></ul><h2 id=configure-chef-server-to-report-to-visibility>Configure Chef Server to report to Visibility</h2><p>You&rsquo;ll also need <a href=https://docs.chef.io/setup_visibility_chef_automate.html#configure-chef-server-to-send-server-object-data>the Chef Server to report to Visibility</a>. To do this:</p><ul><li>Add the following settings to <code>/etc/opscode/chef-server.rb</code>:</li></ul><div class=highlight><pre style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ruby data-lang=ruby>data_collector<span style=color:#000;font-weight:700>[</span><span style=color:#d14>&#39;root_url&#39;</span><span style=color:#000;font-weight:700>]</span> <span style=color:#000;font-weight:700>=</span> <span style=color:#d14>&#39;https://my-automate-server.mycompany.com/data-collector/v0/&#39;</span>
data_collector<span style=color:#000;font-weight:700>[</span><span style=color:#d14>&#39;token&#39;</span><span style=color:#000;font-weight:700>]</span> <span style=color:#000;font-weight:700>=</span> <span style=color:#d14>&#39;TOKEN&#39;</span>
</code></pre></div><h2 id=configure-chef-client-to-report-to-visiblity>Configure Chef Client to report to Visiblity</h2><p>You&rsquo;ll need to make sure your Chef-Client is on a fairly recent version. For me I need to update chef-client in my infrastructure to 12.15.19 for this to work properly. I had some problems on an earlier version.</p><p>Now that we&rsquo;re on the latest, let&rsquo;s configure the <code>data_collector</code> on the node in the <code>client.rb</code>:</p><div class=highlight><pre style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ruby data-lang=ruby>data_collector<span style=color:#000;font-weight:700>.</span>server_url <span style=color:#d14>&#34;https://analytics.yourcompany.ncr/data-collector/v0/&#34;</span>
data_collector<span style=color:#000;font-weight:700>.</span>token <span style=color:#d14>&#34;guid-from-previous-step&#34;</span>
</code></pre></div><h2 id=configure-notification-replacement-for-analytics>Configure Notification replacement for Analytics</h2><p>We were taking advantage of the notifications in Chef Analytics and needed a replacement. My colleague has written <a href=https://github.com/jkerry/SimpleSlackHandler>a slack notifier report handler</a> for Chef that we&rsquo;re now using.</p><h1 id=initial-thoughts-on-visibility>Initial Thoughts on Visibility</h1><p>First of all, I&rsquo;m really impressed with the Chef team for thinking out of the box and getting me on their new platform in a way that works for me. This underscores once again why they&rsquo;re a great partner: <strong>Chef doesn&rsquo;t show up with an inflexible agenda; they listen, find the <em>right</em> solution, and then execute.</strong></p><p>My first impressions of the product are that it looks very nice and clean. I can tell Chef has hired some UX people. :)</p><p>Visibility definitely has room to grow but it&rsquo;s an exciting start to a great platform for making Chef operable at scale within the enterprise. While some in the open source community might elect to roll their own reporting platform for Chef-related stuff, to us that&rsquo;s the path pain and discomfort, because we realize that we&rsquo;ll never have the funding that Chef has to deliver this. And they like hearing from people like me give them feedback. So to me that&rsquo;s the best of both worlds.</p><p>I don&rsquo;t like how the Visibility product is tied to workflow, though. I can understand how Chef wants to sell an all-in-one solution, but to me it&rsquo;s better to design your products with as little coupling as possible so they can be independent. From their perspective, it may make sense; keep things simple so your support can be focused in one direction.</p><p>I&rsquo;m really glad I converted my Chef Analytics server to a Visibility server. Hopefully this helps you do the same.</p></div><section class="my-5 pt-10 pb-5 border-t border-gray-400 flex items-center"><img alt="Avatar photo" class="border border-gray-400 p-1 w-10 h-10 rounded-full mr-3" src=/images/michael.jpg>
<span class=flex-grow>Michael Hedgpeth</span>
<a href="http://twitter.com/share?url=https%3a%2f%2fhedge-ops.com%2fanalytics-to-visibility%2f&text=Migrating%20from%20Chef%20Analytics%20to%20Chef%20Visibility&via=michaelhedgpeth" class="text-white text-xs font-bold rounded-md no-underline flex items-center px-3 py-2 bg-twitter hover:color-white hover:opacity-75 no-underline"><svg class="fill-current w-4 h-4 mr-2" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><title>Twitter</title><path d="M6.29 18.25c7.55.0 11.67-6.25 11.67-11.67v-.53c.8-.59 1.49-1.3 2.04-2.13-.75.33-1.54.55-2.36.65a4.12 4.12.0 001.8-2.27c-.8.48-1.68.81-2.6 1a4.1 4.1.0 00-7 3.74 11.65 11.65.0 01-8.45-4.3 4.1 4.1.0 001.27 5.49C2.01 8.2 1.37 8.03.8 7.7v.05a4.1 4.1.0 003.3 4.03 4.1 4.1.0 01-1.86.07 4.1 4.1.0 003.83 2.85A8.23 8.23.0 010 16.4a11.62 11.62.0 006.29 1.84"/></svg>Tweet</a></section><section class="my-5 py-5 relative"><h2>Interactions</h2></section></article><aside class=flex><a class="w-full md:w-1/2 flex flex-col items-center py-7 px-3 no-underline rounded-md hover:bg-white transition duration-300 ease-in-out" href=/chef-with-windows/><span class="border border-gray-6 text-xs rounded-md mb-2 uppercase font-bold py-2 px-3">Read this next</span>
<span class=text-center>Chef with Windows</span></a>
<a class="w-full md:w-1/2 flex flex-col items-center py-7 px-3 no-underline rounded-md hover:bg-white transition duration-300 ease-in-out" href=/margin-for-leadership/><span class="border border-gray-6 text-xs rounded-md mb-2 uppercase font-bold py-2 px-3">You might enjoy</span>
<span class=text-center>Margin for Leadership</span></a></aside></main><footer class="w-full max-w-7xl mx-auto text-center border-t border-gray-200 py-9 px-3 mt-9 pin-b text-sm text-gray-500">Made with <a href=https://gohugo.io class="underline transition duration-300 ease-in-out hover:text-blue-600">Hugo</a> and <a href=https://github.com/leonardofaria/bento class="underline transition duration-300 ease-in-out hover:text-blue-600">Bento theme</a>.
Copyright Â© 2020 Michael Hedgpeth</footer><script>var initMenu=()=>{var navButtons=document.querySelectorAll('.nav-button');var navMenu=document.querySelector('#nav-menu');var navSocialLinks=document.querySelector('#nav-social-links');for(var button of navButtons){button.addEventListener('click',()=>{console.log('click')
navMenu.classList.toggle("hidden");if(navSocialLinks){navSocialLinks.classList.toggle("hidden");}
for(var navButton of navButtons){navButton.classList.toggle("hidden");};});}}
document.addEventListener('turbolinks:load',initMenu());</script><script>var initHeader=()=>{let scrollPos=window.scrollY;var header=document.querySelector('#header');var headerContainer=document.querySelector("#header-container");var readingProgressBar=document.querySelector("#reading-progress-bar");let scrollTop=0;let scrollBottom=0;let scrollPercent=0;var addClassOnScroll=()=>{header.classList.add("shadow");header.classList.add("bg-white-90");}
var removeClassOnScroll=()=>{header.classList.remove("shadow");header.classList.remove("bg-white-90");}
window.onscroll=function(){scrollPos=window.scrollY;scrollTop=document.documentElement["scrollTop"]||document.body["scrollTop"];scrollBottom=(document.documentElement["scrollHeight"]||document.body["scrollHeight"])-document.documentElement.clientHeight;scrollPercent=scrollTop/scrollBottom*100;readingProgressBar.style.width=(scrollTop/scrollBottom*100)+'%';if(scrollPos>0){addClassOnScroll()}
else{removeClassOnScroll()}}}
document.addEventListener('turbolinks:load',initHeader());</script></body></html>